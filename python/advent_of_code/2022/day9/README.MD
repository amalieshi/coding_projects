The solution is not working. I am unable to figure out why it doesn't produce the correct solution but oh well.
I might come back to this later. The good news is that it is close to the right solution. Maybe I just miss a small issue.